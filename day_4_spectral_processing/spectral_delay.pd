#N canvas 619 469 1263 698 12;
#N canvas 1164 182 438 955 fft-analysis 0;
#X obj 15 164 *~;
#X obj 14 198 rfft~;
#X obj 19 856 *~;
#X obj 20 724 rifft~;
#X obj 19 884 outlet~;
#X obj 14 99 inlet~;
#X text 223 138 windowing;
#X obj 21 318 tabreceive~ delay;
#X obj 20 394 -~;
#X obj 58 369 wrap~;
#X obj 19 482 *~ 512;
#X obj 20 601 /~ 44.1;
#X obj 20 644 vd~ ar1;
#X obj 89 644 vd~ ar2;
#X text 215 230 fft-Analysis is;
#X text 191 253 writte to the;
#X text 201 275 buffers;
#X text 164 322 delay array uses buffer;
#X text 165 344 to determine reading;
#X text 167 365 position;
#X text 65 396 only integers \, jump to bin no.;
#X text 86 600 conversion to milliseconds;
#X text 161 643 reading buffers;
#X text 79 722 resynthesis;
#X text 84 803 normalization;
#X text 225 831 final windowing;
#X obj 36 140 tabreceive~ hanningWindow;
#X obj 37 831 tabreceive~ hanningWindow;
#X obj 58 450 r windowSize;
#X text 88 481 every bin is N samples in size;
#X obj 66 543 samplerate~;
#X obj 66 519 loadbang;
#X obj 66 568 / 1000;
#X obj 59 751 r windowSize;
#X obj 59 777 * 1.5;
#X obj 20 803 /~ 786;
#X obj 199 794 block~ 2048 4;
#X msg 199 771 set \$1 4;
#X obj 14 256 delwrite~ ar1 10000;
#X obj 49 228 delwrite~ ar2 10000;
#X connect 0 0 1 0;
#X connect 1 0 38 0;
#X connect 1 1 39 0;
#X connect 2 0 4 0;
#X connect 3 0 35 0;
#X connect 5 0 0 0;
#X connect 7 0 8 0;
#X connect 7 0 9 0;
#X connect 8 0 10 0;
#X connect 9 0 8 1;
#X connect 10 0 11 0;
#X connect 11 0 12 0;
#X connect 11 0 13 0;
#X connect 12 0 3 0;
#X connect 13 0 3 1;
#X connect 26 0 0 1;
#X connect 27 0 2 1;
#X connect 28 0 10 1;
#X connect 30 0 32 0;
#X connect 31 0 30 0;
#X connect 32 0 11 1;
#X connect 33 0 34 0;
#X connect 33 0 37 0;
#X connect 34 0 35 1;
#X connect 35 0 2 0;
#X connect 37 0 36 0;
#X restore 273 368 pd fft-analysis;
#N canvas 0 0 454 304 (subpatch) 0;
#X array delay 1024 float 3;
#A 0 559.317 559.317 45.3722 6.32436 13.424 15.1989 20.5236 24.0734
122.26 120.476 118.693 116.91 115.127 113.344 111.56 111.56 111.56
110.966 110.371 109.777 109.183 108.588 107.994 107.994 107.994 107.994
107.994 107.994 107.994 107.994 107.994 107.994 107.994 107.994 107.994
107.994 107.994 107.994 107.994 107.994 107.994 107.994 107.994 107.994
107.994 107.994 107.994 107.994 107.994 107.994 107.994 107.994 107.994
106.211 104.427 104.427 104.427 104.427 104.427 104.427 104.427 102.644
100.861 99.9693 99.0776 98.186 97.2944 97.2944 97.2944 97.2944 97.2944
97.2944 97.2944 96.4028 95.5112 94.6196 93.7279 93.7279 93.7279 93.7279
93.7279 91.9447 90.1615 89.2699 88.3782 87.4866 86.595 86.595 86.595
85.7034 84.8118 83.9202 83.0285 83.0285 83.0285 83.0285 83.0285 83.0285
83.0285 83.0285 83.0285 83.0285 83.0285 83.0285 83.0285 83.0285 83.0285
83.0285 83.0285 83.0285 83.0285 83.0285 83.0285 83.0285 83.0285 83.0285
83.0285 83.0285 83.0285 83.0285 83.0285 83.0285 83.0285 83.0285 83.0285
83.0285 83.0285 83.0285 83.0285 83.0285 83.0285 83.0285 83.0285 83.4743
83.9202 84.366 84.8118 85.2576 85.7034 86.1492 86.595 87.7838 88.9726
90.1615 91.3503 92.5391 93.7279 93.7279 93.7279 93.7279 93.7279 93.7279
93.7279 93.7279 93.7279 93.7279 93.7279 93.7279 93.7279 93.7279 93.7279
93.7279 93.7279 93.7279 93.7279 93.7279 93.7279 93.7279 93.7279 93.7279
93.7279 93.7279 93.7279 93.7279 93.7279 93.7279 93.7279 93.7279 93.7279
91.9447 90.1615 85.4062 84.2174 83.0285 81.8397 80.6509 79.4621 77.6788
75.8956 74.1124 72.3291 70.5459 68.7627 66.9794 65.1962 64.3046 63.413
62.5213 61.6297 60.7381 59.8465 58.9549 58.0633 58.0633 58.0633 58.0633
58.0633 58.0633 58.0633 58.0633 58.0633 58.0633 58.0633 58.0633 58.0633
58.0633 58.0633 58.0633 58.0633 58.0633 58.0633 58.0633 58.0633 58.0633
58.0633 59.8465 61.6297 61.6297 61.6297 61.6297 61.6297 61.6297 61.6297
62.5213 63.413 64.3046 65.1962 66.5336 67.871 69.2085 70.5459 71.8833
73.2207 74.5582 75.8956 76.3414 76.7872 77.233 77.6788 78.1246 78.5704
79.0163 79.4621 80.6509 81.8397 83.0285 84.2173 85.4062 86.595 87.9324
89.2699 90.6073 91.9447 93.2821 94.6196 95.957 97.2944 98.186 99.0776
99.9693 100.861 101.752 102.644 103.536 104.427 105.319 106.211 107.102
107.994 108.885 109.777 110.669 111.56 112.452 113.344 114.235 115.127
116.018 116.91 117.802 118.693 119.585 120.476 121.368 122.26 123.597
124.935 126.272 127.609 128.947 130.284 131.622 132.959 134.148 135.337
136.526 137.714 138.903 140.092 140.984 141.875 142.767 143.658 144.55
145.442 146.333 147.225 147.225 147.225 147.225 147.225 147.225 147.225
147.225 147.225 147.225 147.225 147.225 147.225 147.225 147.225 147.225
147.225 147.225 147.225 147.225 147.225 147.225 147.225 147.225 147.225
147.225 147.225 147.225 147.225 146.868 146.512 146.155 145.798 145.442
145.085 144.728 144.372 144.015 143.659 143.658 143.658 143.658 143.658
143.658 143.658 143.658 143.658 143.658 143.658 143.658 143.658 143.658
143.658 143.658 143.658 143.213 142.767 142.321 141.875 141.429 140.984
140.538 140.092 139.646 139.2 138.755 138.309 137.863 137.417 136.971
136.526 136.08 135.634 135.188 134.742 134.297 133.851 133.405 132.959
132.513 132.068 131.622 131.176 130.73 130.284 129.839 129.393 128.947
128.501 128.055 127.61 127.164 126.718 126.272 125.826 125.826 125.826
125.826 125.826 125.826 125.826 125.826 125.826 125.826 125.826 125.826
125.826 125.826 125.826 125.826 125.826 125.826 125.826 125.826 125.826
125.826 125.826 125.628 125.43 125.232 125.034 124.835 124.637 124.439
124.241 124.043 123.845 123.647 123.449 123.25 123.052 122.854 122.656
122.458 122.26 121.935 121.611 121.287 120.963 120.639 120.314 119.99
119.666 119.342 119.017 118.693 118.369 118.045 117.721 117.396 117.072
116.748 116.424 116.099 115.775 115.451 115.127 114.478 113.83 113.181
112.533 111.885 111.236 110.588 109.939 109.291 108.642 107.994 107.345
106.697 106.049 105.4 104.752 104.103 103.455 102.806 102.158 101.509
100.861 100.638 100.415 100.192 99.9693 99.7464 99.5235 99.3006 99.0777
98.8548 98.6319 98.409 98.1861 97.9632 97.7403 97.5174 97.2945 96.7
96.1056 95.5112 94.9168 94.3223 93.7279 93.2821 92.8363 92.3905 91.9447
91.4989 91.0531 90.6073 90.1615 88.3782 86.595 84.8118 83.0285 173.082
172.19 165.057 157.924 152.574 147.225 143.658 140.092 136.525 132.959
129.392 125.826 122.259 118.693 115.127 111.56 107.994 104.427 100.861
97.2942 92.8361 88.378 83.92 79.4619 77.6786 75.8954 74.1122 72.3289
70.5457 68.7625 68.7625 68.7625 68.7625 68.7625 68.7625 68.7625 69.6541
70.5457 71.4373 72.3289 75.8954 79.4619 81.2451 83.0283 84.8116 86.5948
88.378 90.1613 93.7277 97.2942 99.0774 100.861 102.644 104.427 106.21
107.994 109.777 111.56 113.343 115.127 115.127 115.127 115.127 115.127
115.127 115.127 115.127 115.127 115.127 115.127 115.127 115.127 115.127
115.127 115.127 115.127 115.127 115.127 115.127 115.127 115.127 115.127
115.127 115.127 115.127 115.127 115.127 115.127 113.789 112.452 111.114
109.777 108.439 107.102 105.765 104.427 102.644 100.861 99.0774 97.2942
95.511 93.7277 92.6578 91.5878 90.5179 89.448 88.378 87.3081 86.2382
85.1682 84.0983 83.0284 81.6018 80.1752 78.7486 77.322 75.8954 74.4688
73.0422 71.6156 70.1891 68.7625 68.1681 67.5737 66.9792 66.3848 65.7904
65.196 63.4128 61.6295 59.8463 58.0631 57.1714 56.2798 55.3882 54.4966
53.605 52.7134 51.8217 50.9301 52.7134 61.6295 66.9792 72.3289 74.1122
75.8954 77.6786 79.4619 81.2451 83.0283 87.4864 91.9445 96.4026 100.861
106.21 111.56 114.235 116.91 119.585 122.259 125.826 129.392 132.959
136.525 139.2 141.875 144.55 147.225 149.9 152.574 155.249 157.924
159.707 161.491 163.274 165.057 166.84 168.624 169.515 170.407 171.298
172.19 170.407 168.624 166.84 165.057 164.463 163.868 163.274 162.679
162.085 161.491 160.421 159.351 158.281 157.211 156.141 155.071 154.001
152.931 151.861 150.791 150.078 149.365 148.651 147.938 147.225 146.511
145.798 145.085 144.372 143.658 142.271 140.884 139.497 138.11 136.724
135.337 133.95 132.563 131.176 129.789 128.402 127.015 125.628 124.241
122.854 121.467 120.08 118.693 116.91 115.127 113.343 111.56 109.777
107.994 106.21 104.427 102.644 100.861 99.7461 98.6316 97.5171 96.4025
95.288 94.1735 93.059 91.9445 90.83 89.7154 88.6009 87.4864 86.3719
85.2574 84.1429 83.0283 81.9584 80.8884 79.8185 78.7486 77.6786 76.6087
75.5387 74.4688 73.3989 72.3289 70.9024 69.4758 68.0492 66.6226 65.196
63.7694 62.3428 60.9162 59.4897 58.0631 56.8742 55.6854 54.4966 53.3078
52.119 50.9301 54.4966 79.4619 83.0283 86.5948 91.0529 95.511 99.9691
104.427 109.777 115.127 122.259 129.392 132.959 136.525 140.983 145.442
149.9 161.491 163.274 168.624 170.407 172.19 172.19 172.19 172.19 172.19
172.19 172.19 172.19 172.19 172.19 172.19 172.19 172.19 172.19 172.19
172.19 172.19 171.12 170.05 168.98 167.91 166.84 165.77 164.7 163.631
162.561 161.491 159.962 158.434 156.905 155.377 153.848 152.32 150.791
149.263 147.734 146.206 144.677 143.149 141.62 140.092 137.417 134.742
132.067 129.392 127.609 125.826 124.043 122.259 120.476 118.693 116.91
115.127 113.343 111.56 109.777 107.994 107.994 107.994 107.994 107.994
107.994 107.994 107.994 107.994 107.994 107.994 108.588 109.182 109.777
110.371 110.966 111.56 115.127 118.693 120.476 132.959 134.742 136.525
136.525 136.525 136.525 136.525 136.525 136.525 136.525 136.525 136.525
136.525 136.525 136.525 135.931 135.337 134.742 134.148 133.553 132.959
131.176 129.392 127.609 125.826 124.043 122.259 120.476 118.693 116.91
115.127 113.343 111.56 111.56 111.56 111.56 111.56 111.56 111.56 111.56
111.56 111.56 111.56 111.56 111.56 111.56 111.56 109.777 107.994 107.994
104.427 97.2942 90.1613 86.5948 72.3289 69.6541 66.9792 64.3044 50.9301
47.3637 33.0978 29.5313 22.3984 20.6152 18.8319 19.7235 20.6152 21.5068
22.3984 24.1816 43.7972 50.9301 90.1613 93.7277 111.56 115.127 118.693
120.476 122.259 125.826 132.959 134.742 136.525 140.092 147.225 149.008
150.791 152.574 157.924 159.707 161.491 163.274;
#A 1000 165.057 166.84 175.756 177.54 179.323 181.106 182.889 184.673
186.456 188.239 190.022 191.806 193.589 195.372 197.155 198.939 200.722
202.505 204.288 0 0 0 0 0;
#X coords 0 1 1024 214.987 512 60 1;
#X restore 152 124 graph;
#X text 671 173 1;
#X text 148 184 0;
#X text 117 182 Hz:;
#X text 148 203 0;
#X text 595 611 3.8.2.4. Spectral Delay;
#X text 297 79 first draw the delay pattern...;
#X text 623 570 www.pd-tutorial.com;
#X text 636 548 Johannes Kreidler;
#N canvas 470 219 565 454 hann-window 0;
#N canvas 0 0 450 300 (subpatch) 0;
#X array hanningWindow 2048 float 0;
#X coords 0 1 2047 0 300 100 1;
#X restore 82 311 graph;
#X obj 438 165 osc~;
#X obj 438 190 *~ -0.5;
#X obj 438 214 +~ 0.5;
#X obj 38 183 /;
#X obj 127 152 samplerate~;
#X obj 38 261 s window-sec;
#X obj 177 214 swap;
#X obj 177 238 /;
#X obj 177 262 s window-hz;
#X obj 49 211 * 1000;
#X obj 49 238 s window-msec;
#X obj 38 115 t f b f;
#X obj 390 105 r window-hz;
#X msg 442 130 0;
#X obj 390 131 t f b;
#X text 15 8 calculate Hann window table (variable window size) and
constants window-hz (fundamental frequency of analysis) \, window-sec
and window-msec (analysis window size in seconds and msec).;
#X obj 391 247 tabwrite~ hanningWindow;
#X msg 213 142 \; hanningWindow resize \$1;
#X obj 38 88 r windowSize;
#X connect 1 0 2 0;
#X connect 2 0 3 0;
#X connect 3 0 17 0;
#X connect 4 0 6 0;
#X connect 4 0 10 0;
#X connect 5 0 4 1;
#X connect 5 0 7 1;
#X connect 7 0 8 0;
#X connect 7 1 8 1;
#X connect 8 0 9 0;
#X connect 10 0 11 0;
#X connect 12 0 4 0;
#X connect 12 0 7 0;
#X connect 12 1 5 0;
#X connect 12 2 18 0;
#X connect 13 0 15 0;
#X connect 14 0 1 1;
#X connect 15 0 1 0;
#X connect 15 1 14 0;
#X connect 15 1 17 0;
#X connect 19 0 12 0;
#X restore 15 202 pd hann-window;
#X msg 15 91 512;
#X msg 15 113 1024;
#X msg 15 135 2048;
#X msg 15 157 4096;
#X obj 15 10 loadbang;
#X obj 15 179 s windowSize;
#X obj 154 62 array size delay;
#X obj 154 33 * 0.5;
#X obj 154 8 r windowSize;
#X text 640 206 samplerate/2;
#X text 773 121 // Y axis is bin positions and max delay time in millisecons
;
#X text 772 136 // the calculations are as follows:;
#X text 771 153 // maxDelTime = (delayBuffer / blockOverlap) - blockOverlap
;
#X text 771 173 // nBinPositions = (maxDelTime * (sampleRate/1000))
/ windowSize;
#X text 666 116 maxDelTime;
#X text 665 130 nBinPositions;
#X obj 780 350 expr ($f2 * ($f3/1000)) / $f1;
#X obj 780 208 r windowSize;
#X obj 780 233 t b f;
#X obj 916 295 samplerate~;
#X floatatom 780 375 10 0 0 0 nBinPositions - -, f 10;
#X obj 16 233 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144 -1
-1;
#X obj 16 253 openpanel;
#X obj 16 301 soundfiler;
#X obj 90 253 table sample1;
#X msg 16 277 read -resize \$1 sample1;
#X obj 272 233 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X msg 211 231 stop;
#X obj 272 257 tabplay~ sample1;
#X obj 780 295 expr ($f1 / 4) - 4;
#X floatatom 780 320 10 0 0 0 maxDelTime - -, f 10;
#X msg 15 426 \; pd dsp \$1;
#X obj 15 384 loadbang;
#X obj 15 406 tgl 15 0 empty empty empty 17 7 0 10 -262144 -1 -1 1
1;
#N canvas 0 89 505 461 output 0;
#X obj 13 106 hsl 42 23 0.01 0.1 1 0 \$0-v \$0-v volume 7 13 1 9 -245500
-13381 -1 4100 0;
#X obj 57 106 tgl 18 0 THIS_IS_HERE_TO_GET_RID_OF_THE_OUTLET \$0-dsp-toggle
dsp 2 9 1 9 -225271 -195568 -33289 1 1;
#N canvas 1009 460 429 371 dsp 0;
#X obj 36 30 inlet;
#X obj 117 227 select 0 1;
#X msg 150 252 6;
#X obj 117 86 route dsp;
#X obj 117 59 receive pd;
#X msg 36 228 dsp \$1;
#X obj 36 253 send pd;
#X msg 231 279 set \$1;
#X msg 117 279 color \$1 20 12;
#X obj 231 310 send \$0-dsp-toggle;
#X msg 117 251 0;
#X obj 251 129 loadbang;
#X obj 231 99 sig~ 1;
#X obj 231 191 snapshot~;
#X obj 251 158 delay 100;
#X obj 117 138 change -1;
#X obj 2 2 cnv 15 425 20 empty empty empty 3 12 0 14 -204280 -1 0;
#X text 6 3 Retrieve and set DSP state;
#X connect 0 0 5 0;
#X connect 0 0 15 0;
#X connect 1 0 10 0;
#X connect 1 1 2 0;
#X connect 2 0 8 0;
#X connect 3 0 15 0;
#X connect 4 0 3 0;
#X connect 5 0 6 0;
#X connect 7 0 9 0;
#X connect 8 0 9 0;
#X connect 10 0 8 0;
#X connect 11 0 14 0;
#X connect 12 0 13 0;
#X connect 13 0 1 0;
#X connect 13 0 7 0;
#X connect 14 0 13 0;
#X connect 15 0 7 0;
#X connect 15 0 1 0;
#X restore 82 148 pd dsp logic;
#X obj 188 31 inlet~;
#X obj 74 268 line~;
#X obj 174 328 *~;
#X obj 194 358 dac~;
#X text 200 51 audio in;
#X obj 250 31 inlet~;
#X obj 236 327 *~;
#X obj 188 102 hip~ 3;
#X obj 250 102 hip~ 3;
#X obj 10 283 send pd;
#X msg 10 262 dsp 1;
#X obj 74 247 pack 0 50;
#X text 141 246 <-- make a ramp to avoid clicks or zipper noise;
#X msg 74 212 0;
#X obj 74 189 moses 0.011;
#X text 294 103 filter out DC;
#X obj 4 3 cnv 15 425 20 empty empty empty 3 12 0 14 -204280 -1 0;
#X text 14 376 Created by Katja Vetter after an idea by Claude Heiland-Allen
;
#X text 10 3 dac~ and DSP switch;
#X connect 0 0 13 0;
#X connect 0 0 17 0;
#X connect 1 0 2 0;
#X connect 3 0 10 0;
#X connect 4 0 9 0;
#X connect 4 0 5 0;
#X connect 5 0 6 0;
#X connect 8 0 11 0;
#X connect 9 0 6 1;
#X connect 10 0 5 1;
#X connect 11 0 9 1;
#X connect 13 0 12 0;
#X connect 14 0 4 0;
#X connect 16 0 14 0;
#X connect 17 0 16 0;
#X connect 17 1 14 0;
#X coords 0 -1 1 1 85 60 1 5 85;
#X restore 271 534 pd output;
#X msg 15 69 256;
#X msg 15 47 128;
#X msg 780 464 \; delay bounds 0 1 \$1 \$2;
#X obj 780 439 pack f f;
#X obj 780 399 t f b;
#X obj 682 400 r windowSize;
#X text 633 191 windowSize / 2;
#X text 427 592 http://www.pd-tutorial.com/english/ch03s08.html;
#X floatatom 443 288 5 0 0 0 - - -, f 5;
#X obj 414 365 *~;
#X obj 301 399 expr 1 - $f1;
#X obj 272 505 +~;
#X obj 272 479 *~;
#X obj 443 337 line~;
#X obj 301 451 line~;
#X msg 301 426 \$1 10;
#X msg 443 312 \$1 10;
#X msg 780 272 10000;
#X text 566 526 variable implementations to;
#X text 18 538 // excercise:;
#X text 440 266 // dry-wet control;
#X text 18 578 // windowSize \, binPosition and;
#X text 18 598 // dry-wet control;
#X text 18 558 // - make your own mappings to;
#X text 18 618 // - create one more delay array;
#X text 18 638 // and two new delay lines in order to;
#X text 18 658 // two different delays running in parallel;
#X connect 0 0 58 0;
#X connect 11 0 16 0;
#X connect 12 0 16 0;
#X connect 13 0 16 0;
#X connect 14 0 16 0;
#X connect 15 0 11 0;
#X connect 18 0 17 0;
#X connect 19 0 18 0;
#X connect 27 0 31 0;
#X connect 28 0 29 0;
#X connect 29 0 63 0;
#X connect 29 0 30 0;
#X connect 29 1 27 0;
#X connect 30 0 27 2;
#X connect 31 0 50 0;
#X connect 32 0 33 0;
#X connect 33 0 36 0;
#X connect 36 0 34 0;
#X connect 37 0 39 0;
#X connect 38 0 39 0;
#X connect 39 0 55 0;
#X connect 39 0 0 0;
#X connect 39 1 37 0;
#X connect 40 0 41 0;
#X connect 41 0 27 1;
#X connect 43 0 44 0;
#X connect 44 0 42 0;
#X connect 46 0 16 0;
#X connect 47 0 16 0;
#X connect 49 0 48 0;
#X connect 50 0 49 1;
#X connect 50 1 49 0;
#X connect 51 0 49 0;
#X connect 54 0 62 0;
#X connect 54 0 56 0;
#X connect 55 0 57 1;
#X connect 56 0 61 0;
#X connect 57 0 45 0;
#X connect 57 0 45 1;
#X connect 58 0 57 0;
#X connect 59 0 55 1;
#X connect 60 0 58 1;
#X connect 61 0 60 0;
#X connect 62 0 59 0;
#X connect 63 0 40 0;
